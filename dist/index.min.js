!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).FetchEventSource={})}(this,(function(e){"use strict";function t(e,n,o={}){let s={};const{instance:r=t,parseJson:a=!0}=o,c=((r.buffer||"")+e).split("\n");r.buffer=c.pop(),c.forEach(((e,t)=>{if(""===e.trim()){if(a)try{s.data=JSON.parse(s.data)}catch(e){}n?.(s,t),s={}}else{const t=e.indexOf(":"),n=e.substring(0,t),o=e.substring(t+1);if(n.trim())if("data"===n)s.data=o;else s[n]=/^\d+$/.test(o)?parseInt(o):o}}))}class n{constructor(){this.controller=new AbortController}async fetch(e,n={}){const{headers:o,signal:s=this.controller.signal,parseJson:r=!0}=n;n.headers={"Content-Type":"application/json",Accept:"text/event-stream",...o};try{const a=await fetch(e,{signal:s,...n});if(!a.ok){const d=a.headers.get("content-type"),l=n.headers.Accept;throw String(d).startsWith(l)||console.error(`Expected content-type to be ${l}, Actual: ${d}`),new Error(`HTTP ${a.status}`)}n.onOpen?.(a);const c=a.body.getReader(),i=new TextDecoder;async function f(){const{done:e,value:o}=await c.read();if(e)return n.done?.(a);t(i.decode(o),n.onMessage,{instance:this,parseJson:r}),f()}f()}catch(p){this.abort(),delete this.buffer,n.onError?.(p)}}abort(){this.controller.abort()}}e.eventsourceParser=t,e.fetchEventSource=async function(...e){const t=new n;return await t.fetch(...e),t}}));
//# sourceMappingURL=index.min.js.map
